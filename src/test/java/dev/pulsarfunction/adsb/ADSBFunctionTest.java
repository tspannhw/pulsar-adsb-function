package dev.pulsarfunction.adsb;

import org.apache.pulsar.common.functions.FunctionConfig;
import org.apache.pulsar.functions.LocalRunner;
import org.apache.pulsar.functions.api.BaseContext;
import org.apache.pulsar.functions.api.Context;
import org.junit.Test;

import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Collection;

import static org.mockito.Mockito.mock;

/**
 * testing
 */
public class ADSBFunctionTest {

    protected Context ctx;

    protected void init(Context ctx) {
        this.ctx = ctx;
    }

    /**
     *
     * persistent://public/default/adsbraw
     */
    public static String JSON_STRING = "{\"now\": 1659642403.8, \"messages\": 157279, \"aircraft\": [{\"hex\": \"a55f6c\", \"alt_baro\": 29550, \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 31008, \"nav_modes\": [\"autopilot\", \"vnav\", \"tcas\"], \"version\": 0, \"nic_baro\": 1, \"nac_p\": 10, \"sil\": 3, \"sil_type\": \"unknown\", \"mlat\": [], \"tisb\": [], \"messages\": 17, \"seen\": 0.5, \"rssi\": -25.6}, {\"hex\": \"c051e4\", \"flight\": \"ACA099  \", \"alt_baro\": 39000, \"alt_geom\": 41125, \"gs\": 457.6, \"track\": 15.5, \"baro_rate\": 0, \"squawk\": \"2266\", \"emergency\": \"none\", \"category\": \"A5\", \"nav_qnh\": 1012.8, \"nav_altitude_mcp\": 39008, \"lat\": 39.901245, \"lon\": -74.964314, \"nic\": 8, \"rc\": 186, \"seen_pos\": 7.3, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 215, \"seen\": 5.2, \"rssi\": -24.9}, {\"hex\": \"a2b0cd\", \"flight\": \"UAL1729 \", \"alt_baro\": 9925, \"alt_geom\": 10475, \"gs\": 326.0, \"track\": 43.9, \"baro_rate\": -576, \"category\": \"A3\", \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 8000, \"nav_heading\": 54.8, \"lat\": 40.20401, \"lon\": -74.968018, \"nic\": 8, \"rc\": 186, \"seen_pos\": 5.4, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 63, \"seen\": 5.4, \"rssi\": -26.3}, {\"hex\": \"a0a2bd\", \"alt_baro\": 11925, \"alt_geom\": 12600, \"gs\": 361.7, \"track\": 195.2, \"baro_rate\": 0, \"lat\": 40.508011, \"lon\": -74.074646, \"nic\": 8, \"rc\": 186, \"seen_pos\": 20.4, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 42, \"seen\": 1.9, \"rssi\": -25.8}, {\"hex\": \"ac6baf\", \"alt_baro\": 1700, \"alt_geom\": 1800, \"gs\": 135.7, \"track\": 191.5, \"baro_rate\": -192, \"squawk\": \"0377\", \"emergency\": \"none\", \"nav_qnh\": 1016.8, \"nav_altitude_mcp\": 1024, \"nav_modes\": [], \"lat\": 40.294373, \"lon\": -74.196533, \"nic\": 8, \"rc\": 186, \"seen_pos\": 17.3, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 59, \"seen\": 1.7, \"rssi\": -26.2}, {\"hex\": \"acd2d3\", \"alt_baro\": 9925, \"alt_geom\": 10475, \"gs\": 345.5, \"track\": 47.8, \"geom_rate\": 0, \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 10016, \"lat\": 40.128845, \"lon\": -74.603394, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.5, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 111, \"seen\": 0.1, \"rssi\": -21.0}, {\"hex\": \"a448d5\", \"flight\": \"UAL1470 \", \"alt_baro\": 27975, \"alt_geom\": 29550, \"gs\": 415.1, \"track\": 238.0, \"baro_rate\": 128, \"squawk\": \"7332\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 20000, \"nav_heading\": 248.9, \"lat\": 40.906289, \"lon\": -74.85697, \"nic\": 8, \"rc\": 186, \"seen_pos\": 18.5, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 256, \"seen\": 2.1, \"rssi\": -25.6}, {\"hex\": \"a2995e\", \"alt_baro\": 7200, \"alt_geom\": 7625, \"gs\": 271.3, \"track\": 209.1, \"geom_rate\": 1408, \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 8000, \"nav_heading\": 222.9, \"lat\": 40.290573, \"lon\": -74.023315, \"nic\": 8, \"rc\": 186, \"seen_pos\": 4.9, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 125, \"seen\": 2.9, \"rssi\": -26.0}, {\"hex\": \"a24aca\", \"flight\": \"JBU250  \", \"alt_baro\": 35000, \"alt_geom\": 36975, \"gs\": 483.5, \"track\": 34.8, \"baro_rate\": -64, \"squawk\": \"2121\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 35008, \"nav_modes\": [\"autopilot\", \"vnav\", \"tcas\"], \"lat\": 40.056656, \"lon\": -74.178162, \"nic\": 8, \"rc\": 186, \"seen_pos\": 1.6, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 795, \"seen\": 0.9, \"rssi\": -25.1}, {\"hex\": \"a5e29a\", \"flight\": \"ASA8    \", \"alt_baro\": 6450, \"alt_geom\": 6900, \"gs\": 295.1, \"track\": 47.1, \"baro_rate\": -1600, \"squawk\": \"2642\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 6016, \"nav_heading\": 56.2, \"lat\": 40.371506, \"lon\": -74.741699, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.8, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 920, \"seen\": 0.1, \"rssi\": -23.3}, {\"hex\": \"a53fd7\", \"flight\": \"N43721  \", \"alt_baro\": 3500, \"alt_geom\": 3700, \"gs\": 111.1, \"track\": 120.3, \"geom_rate\": -640, \"squawk\": \"1200\", \"emergency\": \"none\", \"category\": \"A1\", \"lat\": 40.308014, \"lon\": -74.624512, \"nic\": 7, \"rc\": 371, \"seen_pos\": 0.3, \"version\": 2, \"nic_baro\": 0, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 705, \"seen\": 0.1, \"rssi\": -15.8}, {\"hex\": \"aa8ab9\", \"flight\": \"N779CS  \", \"alt_baro\": 37075, \"alt_geom\": 39075, \"gs\": 489.3, \"track\": 94.1, \"geom_rate\": -640, \"category\": \"A2\", \"nav_altitude_mcp\": 35008, \"lat\": 40.993423, \"lon\": -74.877014, \"nic\": 8, \"rc\": 186, \"seen_pos\": 3.9, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 220, \"seen\": 1.6, \"rssi\": -26.9}, {\"hex\": \"a34825\", \"category\": \"A3\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 750, \"seen\": 61.1, \"rssi\": -27.1}, {\"hex\": \"ab9f61\", \"flight\": \"GAJ848  \", \"alt_baro\": 15900, \"alt_geom\": 16800, \"gs\": 263.1, \"track\": 226.5, \"geom_rate\": -64, \"category\": \"A1\", \"nav_qnh\": 1016.8, \"nav_altitude_mcp\": 16000, \"nav_heading\": 241.2, \"lat\": 40.563858, \"lon\": -74.778625, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.5, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 680, \"seen\": 0.5, \"rssi\": -23.9}, {\"hex\": \"a6eeb9\", \"flight\": \"JIA5341 \", \"alt_baro\": 26400, \"alt_geom\": 28025, \"gs\": 470.9, \"track\": 39.6, \"geom_rate\": -1344, \"squawk\": \"5635\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1012.8, \"nav_altitude_mcp\": 24000, \"nav_heading\": 54.1, \"lat\": 40.295384, \"lon\": -74.396168, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.1, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 3724, \"seen\": 0.1, \"rssi\": -9.7}, {\"hex\": \"a95de2\", \"flight\": \"VXP369  \", \"alt_baro\": 40000, \"alt_geom\": 42075, \"gs\": 451.8, \"track\": 231.4, \"baro_rate\": 0, \"squawk\": \"4005\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 40000, \"nav_heading\": 246.1, \"lat\": 40.661087, \"lon\": -74.613953, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.0, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 8, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 1, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 3195, \"seen\": 0.0, \"rssi\": -12.7}, {\"hex\": \"a194aa\", \"version\": 0, \"mlat\": [], \"tisb\": [], \"messages\": 15, \"seen\": 277.7, \"rssi\": -27.0}, {\"hex\": \"a38cd2\", \"flight\": \"JBU1955 \", \"alt_baro\": 24425, \"alt_geom\": 25775, \"gs\": 405.7, \"track\": 242.6, \"baro_rate\": -1472, \"squawk\": \"7343\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 22016, \"nav_modes\": [\"autopilot\", \"tcas\"], \"lat\": 40.567296, \"lon\": -74.871639, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.7, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 1726, \"seen\": 0.1, \"rssi\": -21.8}, {\"hex\": \"a3e9c5\", \"flight\": \"DAL507  \", \"alt_baro\": 20700, \"alt_geom\": 21875, \"gs\": 415.7, \"track\": 231.6, \"baro_rate\": 1408, \"squawk\": \"3320\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 34016, \"nav_heading\": 0.0, \"lat\": 40.49663, \"lon\": -74.726882, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.1, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 1599, \"seen\": 0.1, \"rssi\": -11.5}, {\"hex\": \"ac3238\", \"flight\": \"GAJ885  \", \"alt_baro\": 3925, \"alt_geom\": 4150, \"gs\": 211.2, \"track\": 321.0, \"geom_rate\": -64, \"squawk\": \"4266\", \"emergency\": \"none\", \"category\": \"A1\", \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 4000, \"nav_heading\": 329.8, \"lat\": 40.268875, \"lon\": -74.361755, \"nic\": 8, \"rc\": 186, \"seen_pos\": 3.9, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 1, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 374, \"seen\": 0.3, \"rssi\": -21.0}, {\"hex\": \"a2ce7f\", \"flight\": \"N280FG  \", \"alt_baro\": 2475, \"alt_geom\": 2525, \"gs\": 123.1, \"track\": 272.3, \"baro_rate\": 256, \"squawk\": \"1200\", \"emergency\": \"none\", \"category\": \"A1\", \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 2496, \"nav_modes\": [], \"lat\": 40.240585, \"lon\": -74.617493, \"nic\": 9, \"rc\": 75, \"seen_pos\": 1.0, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 2120, \"seen\": 0.4, \"rssi\": -18.4}, {\"hex\": \"a3db93\", \"flight\": \"FFT2570 \", \"alt_baro\": 24275, \"alt_geom\": 25750, \"gs\": 441.0, \"track\": 56.1, \"baro_rate\": -768, \"squawk\": \"0567\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1012.8, \"nav_altitude_mcp\": 19008, \"lat\": 40.481733, \"lon\": -73.914892, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.1, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 9, \"nac_v\": 4, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 3, \"mlat\": [], \"tisb\": [], \"messages\": 3868, \"seen\": 0.1, \"rssi\": -13.0}, {\"hex\": \"a63e46\", \"alt_baro\": 5900, \"category\": \"A2\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 1089, \"seen\": 45.4, \"rssi\": -27.7}, {\"hex\": \"a4c717\", \"category\": \"A7\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 545, \"seen\": 242.5, \"rssi\": -26.8}, {\"hex\": \"a46f24\", \"category\": \"A2\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 81, \"seen\": 201.4, \"rssi\": -28.0}, {\"hex\": \"a3813b\", \"alt_baro\": 24750, \"category\": \"A3\", \"lat\": 40.299362, \"lon\": -75.141052, \"nic\": 8, \"rc\": 186, \"seen_pos\": 62.3, \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 3910, \"seen\": 36.7, \"rssi\": -26.4}, {\"hex\": \"a688f4\", \"category\": \"A1\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 372, \"seen\": 80.5, \"rssi\": -26.3}, {\"hex\": \"ab79de\", \"category\": \"A3\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 3830, \"seen\": 75.8, \"rssi\": -27.5}, {\"hex\": \"a29982\", \"alt_baro\": 2300, \"category\": \"A1\", \"lat\": 40.235641, \"lon\": -74.787476, \"nic\": 9, \"rc\": 75, \"seen_pos\": 61.8, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 199, \"seen\": 56.4, \"rssi\": -26.7}, {\"hex\": \"a1e540\", \"alt_baro\": 3400, \"alt_geom\": 3550, \"gs\": 132.2, \"track\": 93.5, \"baro_rate\": 128, \"category\": \"A1\", \"nav_qnh\": 1016.0, \"nav_altitude_mcp\": 3488, \"nav_modes\": [], \"lat\": 40.140319, \"lon\": -74.355968, \"nic\": 9, \"rc\": 75, \"seen_pos\": 39.0, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 2412, \"seen\": 39.0, \"rssi\": -24.3}, {\"hex\": \"a146f9\", \"category\": \"A4\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 2974, \"seen\": 71.9, \"rssi\": -25.9}, {\"hex\": \"a3133d\", \"flight\": \"N298AL  \", \"alt_baro\": 35875, \"alt_geom\": 37925, \"gs\": 512.0, \"track\": 263.8, \"baro_rate\": 1344, \"squawk\": \"6657\", \"emergency\": \"none\", \"category\": \"A3\", \"nav_qnh\": 1013.6, \"nav_altitude_mcp\": 43008, \"nav_modes\": [\"autopilot\", \"tcas\"], \"lat\": 40.155448, \"lon\": -75.082626, \"nic\": 8, \"rc\": 186, \"seen_pos\": 0.7, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 6739, \"seen\": 0.2, \"rssi\": -20.1}, {\"hex\": \"a8f9a3\", \"category\": \"A3\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 4292, \"seen\": 172.6, \"rssi\": -26.9}, {\"hex\": \"a0d6a8\", \"category\": \"A3\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 4403, \"seen\": 173.8, \"rssi\": -24.7}, {\"hex\": \"ab839d\", \"alt_baro\": 30350, \"alt_geom\": 32125, \"gs\": 448.9, \"track\": 229.4, \"geom_rate\": 1664, \"category\": \"A5\", \"version\": 2, \"nac_v\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 5244, \"seen\": 23.0, \"rssi\": -26.6}, {\"hex\": \"a36850\", \"category\": \"A2\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 4166, \"seen\": 134.4, \"rssi\": -26.0}, {\"hex\": \"a999fd\", \"category\": \"A2\", \"version\": 2, \"sil_type\": \"perhour\", \"mlat\": [], \"tisb\": [], \"messages\": 8171, \"seen\": 234.9, \"rssi\": -28.9}, {\"hex\": \"a53810\", \"flight\": \"N4350G  \", \"alt_baro\": 3500, \"alt_geom\": 3575, \"gs\": 93.0, \"track\": 168.2, \"geom_rate\": 576, \"category\": \"A1\", \"lat\": 40.238684, \"lon\": -74.249164, \"nic\": 9, \"rc\": 75, \"seen_pos\": 45.1, \"version\": 2, \"nic_baro\": 1, \"nac_p\": 10, \"nac_v\": 2, \"sil\": 3, \"sil_type\": \"perhour\", \"gva\": 2, \"sda\": 2, \"mlat\": [], \"tisb\": [], \"messages\": 5312, \"seen\": 45.1, \"rssi\": -23.1}]}";

    /**
     *
     * @param msg
     */
    protected void log(String msg) {
        if (ctx != null && ctx.getLogger() != null) {
            ctx.getLogger().info(String.format("Function: [%s, id: %s, instanceId: %d of %d] %s",
                    ctx.getFunctionName(), ctx.getFunctionId(), ctx.getInstanceId(), ctx.getNumInstances(), msg));
        }
    }

    @Test
    public void testADSBFunction() {
        ADSBFunction func = new ADSBFunction();
        func.process(JSON_STRING.getBytes(StandardCharsets.UTF_8), mock(Context.class));
    }

    /**
     * @param args   string arguments
     * @throws Exception
     */
    public static void main(String[] args) throws Exception {

        // multiple topics
        Collection<String> inputTopics = new ArrayList<String>();
        inputTopics.add("persistent://public/default/adsbraw");

       FunctionConfig functionConfig = FunctionConfig.builder()
                .className(ADSBFunction.class.getName())
                .inputs(inputTopics)
                .name("ADBSFunc")
                .runtime(FunctionConfig.Runtime.JAVA)
                .autoAck(true)
                .build();

       LocalRunner localRunner = LocalRunner.builder()
               .brokerServiceUrl("pulsar://pulsar1:6650")
               .functionConfig(functionConfig)
               .build();

        /**
        LocalRunner localRunner = LocalRunner.builder()
                .brokerServiceUrl("pulsar+ssl://demo.sndemo.snio.cloud:6651")
                .clientAuthPlugin("org.apache.pulsar.client.impl.auth.AuthenticationToken")
                .clientAuthParams("------")
                .functionConfig(functionConfig)
                .build();
         */

        localRunner.start(false);
        Thread.sleep(30000);
        localRunner.stop();
        System.exit(0);
    }
}
